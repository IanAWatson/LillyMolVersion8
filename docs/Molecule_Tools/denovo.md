# De-Novo Molecule Generation
LillyMol contains several tools that can be used for Cheminformatics driven molecule
generation. All of these tools start with existing molecules and make changes
based on various strategies.

## Ring Replacement
This is a powerful technique for identifying likely synthetically feasible analogues
of starting molecules. See [ring_replacement](/docs/Molecule_Tools/ring_replacement.md)

## Sidechain Replacement
[sidechain_replacement](/docs/Workflows/sidechain_replacement.md) shows how that tool
can be used for the common task of replacing one sidechain with another, usually
sidechains discerned from known collections of molecules.

## Linker Replacement
[linker_replacement](/docs/Workflows/linker_replacement.md) shows how that tool
can be used for replacing an existing linker region with precedented linker groups
from known collections.

## Medchem Wizard
This is an implementation of work I believe originated at Abbot. Unfortunately I have
lost the original reference. The system consists of over 250 reactions that describe
likely isosteric replacements.
The script [medchem_wizard.sh](/contrib/bin/medchem_wizard.sh)
is a wrapper which sets up these reactions and calls the underlying c++ executable.
Starting with 1000 random molecules from Chembl,
this generates almost 500k molecules in about 7 seconds.

Note that like many cheminformatics driven molecular evolution tools, this will tend to increase
the size of the molecules generated. For example, the random set used above has an average atom count
of 28.6 heavy atoms, whereas the products generated by medchem_wizard on that set have an average
of 34.7 heavy atoms. The -M option to the script can be used to discard product molecules
with too many atoms.

Reactions that add too many atoms could be discarded, although there is no automated means
of doing this.

## minor_changes
This is described at [minor_changes](/docs/Molecule_Tools/minor_changes.md). Turning 1000
starting molecules into several hundred thousand variants is quick.
Again there is a tendency to generate larger molecules than the starting set, but possibly
less pronounced than Medchem Wizard.

Whereas MedchemWizard is very chemically aware, minor_changes is less so.

## random_molecular_permutations
This is described at [random_molecular_permutations](/docs/Molecule_Tools/random_molecular_permutations.md).
This is a structure aware tool that performs chemically aware, but very risky transformations.
Using the wrapper script [contrib/bin/random_molecular_permutations.sh](/contrib/bin/random_molecular_permutations.sh)
1000 random Chembl molecules will generate 3.6M molecules in about 90 seconds.

These also have a tendency to be larger than the starting molecules.

## safe_generate
This is possibly one of the most robust of the denovo tools in LillyMol. See
[safe_generate](/docs/Molecule_Tools/SAFE.md) for a details. Because it uses
pre-generated fragments, one can exert a lot of control over molecule
formation. Also, when inter-molecular "breeding" is uses, there is also a lot
of control over how similar the excised and replacement fragment must be.

## smiles_mutation
This is the most "uncontrolled" of the molecule generators in LillyMol. It uses text
transformations on smiles, and attempts molecule interpretation on the resulting
strings. This can generate quite outlandish molecules, but which have valid valences.
Successful smiles interpretation tends to be relative rare, so the numbers of
molecules generated can be low. There will be many error messages about failed
smiles interpretation.

Invoking it as
```
${LILLYMOL_HOME}/contrib/contrib/bin/smiles_mutation.sh -N 10 -n 5 -x 3 -p 20 -w 5 -v -O pia=0.4 -O pie=0.4 input.smi
```
Generates 16k molecules in about 5 seconds. The log message concludes
```
produced 157794 smiles
157794 attempts at molecular interpretation
33134 valid molecules produced
16188 molecules with invalid valences produced
482 rejected for re-creating initial structures
0 non organic molecules discarded
0 non periodic table molecules discarded
16464 smiles written
Molecules had between 1 and 76 atoms, ave 22.2663
Molecules had between 0 and 11 rings, ave 2.89863
7117 molecules produced at generation 1
3623 molecules produced at generation 2
2331 molecules produced at generation 3
1798 molecules produced at generation 4
1595 molecules produced at generation 5
```
So of 157k smiles gnerated, only 33k were valid smiles. Of those only 16k
were valid valences.

Given the "wild" molecules that can be generated, use of this tool is
not common. The most productive uses might be with a relatively small
set of known actives, but even then other tools may be more
useful.

Consider this one mostly for fun.

# Reaction Based Enumeration

LillyMol supports several means of applying reactions. The most basic
is [trxn](/docs/Molecule_Tools/trxn.md) which offers a great deal of
flexibility in how a given reaction is applied to sets of reagents
and possibly also sidechains.

There are other tools, molecular_transformations and multiple_reactions
that are not documented, but which can apply multiple reactions to
a stream of molecules.
